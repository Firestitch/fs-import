<div [hidden]="mode === 'processing'">
  <div [hidden]="mode !== 'config'">
    <fs-list [config]="listConfig" #listConfigEl>
      <fs-list-column>
        <ng-template fs-list-header>Name</ng-template>
        <ng-template fs-list-cell let-row="row">
          {{ row.name }} <div class="description">{{ row.description }}</div>
        </ng-template>
      </fs-list-column>
      <fs-list-column align="center">
        <ng-template fs-list-header>Required</ng-template>
        <ng-template fs-list-cell let-row="row">
          <mat-icon class="required" *ngIf="row.validations.required">check</mat-icon>
        </ng-template>
      </fs-list-column>
      <fs-list-column>
        <ng-template fs-list-header>Validations</ng-template>
        <ng-template fs-list-cell let-row="row">
          <ng-container *ngFor="let item of row.validationsArray">
            <div *ngIf="item.key != 'required'">
              <span *ngIf="item.key == 'values'">Valid values: {{ item.value.join(", ") }}</span>
              <span *ngIf="item.key!= 'values'">Valid {{ item.key }}</span>
            </div>
          </ng-container>
        </ng-template>
      </fs-list-column>
    </fs-list>

    <p>
      <ng-template
        [ngTemplateOutlet]="configTemplate"
        [ngTemplateOutletContext]="{}"
      ></ng-template>
    </p>
  </div>

  <div [hidden]="mode !== 'result'">
    <div *ngIf="mode === 'result'">
      <fs-message
      *ngIf="result.success.count"
      fsType="success"
      fsMessage="{{ result.success.message ? result.success.message : result.success.count + ' Successfully imported' }}">
      </fs-message>

      <fs-message
      *ngIf="result.duplicate.count"
      fsType="info"
      fsMessage="{{
        result.duplicate.message ?
        result.duplicate.message :
        result.duplicate.count + ' Duplicate' + (result.duplicate.count === 1 ? '' : 's') + ' ignored' }}">
      </fs-message>

      <fs-message
      *ngIf="result.fail.count"
      fsType="error"
      fsMessage="{{ result.fail.message ? result.fail.message : result.fail.count + ' Failed to import' }}">
      </fs-message>
    </div>

    <div [hidden]="!resultHasError">
      <fs-list [config]="listResult" #listResultEl>
        <fs-list-column align="center" width="1%">
          <ng-template fs-list-header>Row</ng-template>
          <ng-template fs-list-cell let-row="row">
            {{ row.row }}
          </ng-template>
        </fs-list-column>
        <fs-list-column>
          <ng-template fs-list-header>Preview</ng-template>
          <ng-template fs-list-cell let-row="row">
            {{ row.preview }}
          </ng-template>
        </fs-list-column>
        <fs-list-column>
          <ng-template fs-list-header>Reason</ng-template>
          <ng-template fs-list-cell let-row="row">
            <div *ngFor="let message of row.messages">{{ message }}</div>
          </ng-template>
        </fs-list-column>
      </fs-list>
    </div>

    <p>
      <ng-template
        [ngTemplateOutlet]="resultTemplate"
        [ngTemplateOutletContext]="{}"
      ></ng-template>
    </p>
  </div>
</div>

<div class="progress-container" *ngIf="mode === 'processing'">
  <div class="progress">
    <span>Processing Import</span>
    <mat-spinner diameter="40"></mat-spinner>
  </div>
</div>
